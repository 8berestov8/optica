"use strict";(self["webpackChunklens_app"]=self["webpackChunklens_app"]||[]).push([[166],{7151:(e,t,a)=>{a.d(t,{HG:()=>d,SM:()=>r,fQ:()=>s,gO:()=>i});a(3948);var l=a(9735);const s=async e=>{try{const t=e.map((e=>{console.log(e);const t={product:e.product,product_amount:e.product_amount,product_count:e.product_count,product_discount:e.product_discount,sphere:e.sphere,radius:e.radius,add:e.add,axis:e.ax,dominant:e.dominant,cylinder:e.cylinder,categorie:e.categorie};return l.Z.post("/order-product-details",{data:t}).then((e=>e.data.id)).catch((e=>console.error(e)))}));return Promise.all(t)}catch(t){console.error(t)}},i=async e=>{try{const t={order_product_details:e.order_details,count:e.order.count,total_amount:e.order.total_amount,total_discount:e.order.total_discount,status_delivery:1,user:{id:e.order.user}},a=l.Z.post("/orders",{data:t});return a}catch(t){console.error(t)}},r=async e=>{try{return l.Z.get(`/orders?populate=*&filters[user][id]=${e}`).then((({data:e})=>e.map((e=>{var t;return{id:e.id,date:e.attributes.createdAt,count:e.attributes.count,price:e.attributes.total_discount,deliverTo:e.attributes.deliverTo.data,status:null===(t=e.attributes.status_delivery.data)||void 0===t?void 0:t.attributes.title}})))).catch((e=>console.error(e)))}catch(t){console.error(t)}},d=async e=>{try{return l.Z.get(`/orders/${e}?populate=*`).then((async({data:e})=>(console.log(e),Promise.all(e.attributes.order_product_details.data.map((e=>l.Z.get(`/order-product-details/${e.id}?populate=*`).then((async e=>{var t,a,s,i,r,d,n,o,u,c,m,h,p,f,v,b,g,w,_,y,E,k,W,I,S,T,U,R,A,O,C,$,F,V,P,D,j,Z,x,N,M,q,B,L,z,K,Q,H,G;const Y=await l.Z.get(`/products/${e.data.attributes.product.data.id}?populate=*`).then((e=>e.data.attributes.image.data.map((e=>e.attributes.url))));return console.log(e),{product:{id:e.data.attributes.product.data.id,title:e.data.attributes.product.data.attributes.title,short_title:e.data.attributes.product.data.attributes.short_title,price:e.data.attributes.product.data.attributes.price,discount:e.data.attributes.product.data.attributes.discount,img:Y},price:e.data.attributes.product_discount,count:e.data.attributes.product_count,radius:{id:null===(t=e.data.attributes)||void 0===t||null===(a=t.radius)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.id,title:null===(i=e.data.attributes)||void 0===i||null===(r=i.radius)||void 0===r||null===(d=r.data)||void 0===d||null===(n=d.attributes)||void 0===n?void 0:n.title},sphere:{id:null===(o=e.data.attributes)||void 0===o||null===(u=o.sphere)||void 0===u||null===(c=u.data)||void 0===c?void 0:c.id,title:null===(m=e.data.attributes)||void 0===m||null===(h=m.sphere)||void 0===h||null===(p=h.data)||void 0===p||null===(f=p.attributes)||void 0===f?void 0:f.title},add:{id:null===(v=e.data.attributes)||void 0===v||null===(b=v.add)||void 0===b||null===(g=b.data)||void 0===g?void 0:g.id,title:null===(w=e.data.attributes)||void 0===w||null===(_=w.add)||void 0===_||null===(y=_.data)||void 0===y||null===(E=y.attributes)||void 0===E?void 0:E.title},ax:{id:null===(k=e.data.attributes)||void 0===k||null===(W=k.axi)||void 0===W||null===(I=W.data)||void 0===I?void 0:I.id,title:null===(S=e.data.attributes)||void 0===S||null===(T=S.axi)||void 0===T||null===(U=T.data)||void 0===U||null===(R=U.attributes)||void 0===R?void 0:R.title},cylinder:{id:null===(A=e.data.attributes)||void 0===A||null===(O=A.cylinder)||void 0===O||null===(C=O.data)||void 0===C?void 0:C.id,title:null===($=e.data.attributes)||void 0===$||null===(F=$.cylinder)||void 0===F||null===(V=F.data)||void 0===V||null===(P=V.attributes)||void 0===P?void 0:P.title},dominant:{id:null===(D=e.data.attributes)||void 0===D||null===(j=D.dominant)||void 0===j||null===(Z=j.data)||void 0===Z?void 0:Z.id,title:null===(x=e.data.attributes)||void 0===x||null===(N=x.dominant)||void 0===N||null===(M=N.data)||void 0===M||null===(q=M.attributes)||void 0===q?void 0:q.title},categorie:{id:null===(B=e.data.attributes)||void 0===B||null===(L=B.categorie)||void 0===L||null===(z=L.data)||void 0===z?void 0:z.id,title:null===(K=e.data.attributes)||void 0===K||null===(Q=K.categorie)||void 0===Q||null===(H=Q.data)||void 0===H||null===(G=H.attributes)||void 0===G?void 0:G.title}}})).catch((e=>console.error(e)))))).then((t=>{var a,l,s;return console.log(t),{id:e.id,date:e.attributes.createdAt,count:t.count,order_product_details:t,total_amount:e.attributes.total_amount,total_discount:e.attributes.total_discount,status:null===(a=e.attributes.status_delivery.data)||void 0===a?void 0:a.attributes.title,deliverTo:null!==(l=e.attributes.deliverTo)&&void 0!==l&&l.data?null===(s=e.attributes.deliverTo)||void 0===s?void 0:s.data.attributes:""}}))))).catch((e=>console.error(e)))}catch(t){console.error(t)}}},3226:(e,t,a)=>{function l(){return this.fields={...this.emptyFields},this.errorFields={},this.error="",!0}function s(e){var t,a;let l=!1;if("object"===typeof e&&null!==e&&void 0!==e&&null!==(t=e.response)&&void 0!==t&&null!==(a=t.data)&&void 0!==a&&a.errors){const{errors:t}=e.response.data;Object.keys(t).forEach((e=>{this.errorFields[e]=t[e].join(", ")}))}else Object.keys(this.fields).forEach((e=>{this.requiredFields.indexOf(e)>=0&&!this.fields[e]&&0!==this.fields[e]?(this.errorFields[e]="Обязательно для заполнения",l=!0):this.errorFields[e]=!1}));return l}function i(e){var t,a;let l=!1;if("object"===typeof e&&null!==e&&void 0!==e&&null!==(t=e.response)&&void 0!==t&&null!==(a=t.data)&&void 0!==a&&a.errors){const{errors:t}=e.response.data;Object.keys(t).forEach((e=>{this.errorFields[e]=t[e].join(", ")}))}else Object.keys(this.fields).forEach((e=>{this.requiredFields.indexOf(e)>=0&&!Object.keys(this.fields[e]).length&&0!==this.fields[e]?(this.errorFields[e]="Обязательно для заполнения",l=!0):this.errorFields[e]=!1}));return l}function r(e){var t,a;let l=!1;if("object"===typeof e&&null!==e&&void 0!==e&&null!==(t=e.response)&&void 0!==t&&null!==(a=t.data)&&void 0!==a&&a.errors){const{errors:t}=e.response.data;Object.keys(t).forEach((e=>{this.errorFieldsTwo[e]=t[e].join(", ")}))}else Object.keys(this.fieldsTwo).forEach((e=>{this.requiredFieldsTwo.indexOf(e)>=0&&!Object.keys(this.fieldsTwo[e]).length&&0!==this.fieldsTwo[e]?(this.errorFieldsTwo[e]="Обязательно для заполнения",l=!0):this.errorFieldsTwo[e]=!1}));return l}function d(e){var t,a;let l=!1;if("object"===typeof e&&null!==e&&void 0!==e&&null!==(t=e.response)&&void 0!==t&&null!==(a=t.data)&&void 0!==a&&a.errors){const{errors:t}=e.response.data;Object.keys(t).forEach((e=>{this.errorFields[e]=t[e].join(", ")}))}else Object.keys(this.address).forEach((e=>{this.requiredFieldsAddress.indexOf(e)>=0&&!this.address[e]&&0!==this.address[e]?(this.errorFields[e]="Обязательно для заполнения",l=!0):this.errorFields[e]=!1}));return l}a.d(t,{Ee:()=>l,d6:()=>s,fB:()=>d,ph:()=>r,q9:()=>i})},8172:(e,t,a)=>{a.d(t,{Z:()=>u});a(7658);var l=a(6252),s=a(3577);function i(e,t,a,i,r,d){const n=(0,l.up)("ion-label"),o=(0,l.up)("ion-item"),u=(0,l.up)("ion-icon"),c=(0,l.up)("ion-col"),m=(0,l.up)("ion-row"),h=(0,l.up)("ion-list"),p=(0,l.up)("ion-card-content"),f=(0,l.up)("ion-card");return(0,l.wg)(),(0,l.j4)(f,{class:"address"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{class:"content"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,null,{default:(0,l.w5)((()=>[(0,l.Wm)(o,{lines:"none"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{class:"title"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(a.title),1)])),_:1})])),_:1}),(0,l.Wm)(o,{lines:"none"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{class:"ion-align-items-start ion-nowrap"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"icon-col"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{icon:"assets/icon/location-profile.svg",class:"ion-margin-end icon"})])),_:1}),(0,l.Wm)(c,{class:"text-col"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{class:"text"},{default:(0,l.w5)((()=>[(0,l.Uk)("г. Владивосток, ул. Енисейская, 23Д пом. 102 ")])),_:1}),(0,l._)("div",null,[(0,l._)("a",{herf:"#",class:"link-view-card",onClick:t[0]||(t[0]=t=>e.$router.push({name:"Map"}))},"Посмотреть на карте")])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(o,{lines:"none"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{class:"ion-align-items-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"icon-col"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{icon:"assets/icon/alarm-profile.svg",class:"ion-margin-end icon"})])),_:1}),(0,l.Wm)(c,{class:"text-col"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{class:"text"},{default:(0,l.w5)((()=>[(0,l.Uk)("пн-вс: 09:00-20:00")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}var r=a(3687);const d={name:"Address",props:{title:{type:String,default:""}},components:{IonCol:r.wI,IonCard:r.PM,IonCardContent:r.FN,IonLabel:r.Q$,IonItem:r.Ie,IonList:r.q_,IonIcon:r.gu,IonRow:r.Nd}};var n=a(3744);const o=(0,n.Z)(d,[["render",i]]),u=o},2845:(e,t,a)=>{a.d(t,{Z:()=>u});a(1817);var l=a(6252),s=a(3577);function i(e,t,a,i,r,d){const n=(0,l.up)("ion-icon"),o=(0,l.up)("ion-label"),u=(0,l.up)("ion-row"),c=(0,l.up)("ion-card-content"),m=(0,l.up)("ion-card");return(0,l.wg)(),(0,l.j4)(m,{class:"card-info"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"content"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{class:"ion-align-items-center"},{default:(0,l.w5)((()=>[a.icon?((0,l.wg)(),(0,l.j4)(n,{key:0,icon:a.icon,class:"ion-margin-end icon"},null,8,["icon"])):(0,l.kq)("",!0),(0,l.Wm)(o,{class:"title"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(a.title),1)])),_:1})])),_:1}),(0,l.Wm)(u,{class:"description-row"},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{class:"description"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(a.description),1)])),_:1})])),_:1}),a.subdescription?((0,l.wg)(),(0,l.j4)(u,{key:0,class:"description-row"},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{class:"description"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(a.subdescription),1)])),_:1})])),_:1})):(0,l.kq)("",!0)])),_:1})])),_:1})}var r=a(3687);const d={name:"CardInfo",components:{IonCard:r.PM,IonCardContent:r.FN,IonRow:r.Nd,IonIcon:r.gu,IonLabel:r.Q$},props:{title:{type:String,default:""},icon:{type:String,default:""},description:{type:String,default:""},subdescription:{type:String,default:""}}};var n=a(3744);const o=(0,n.Z)(d,[["render",i]]),u=o},9430:(e,t,a)=>{a.d(t,{Z:()=>p});var l=a(6252),s=a(3577);const i={id:"box"},r={key:0},d={class:"btn-wrapper"};function n(e,t,a,n,o,u){const c=(0,l.up)("ion-button"),m=(0,l.up)("ion-buttons"),h=(0,l.up)("ion-modal");return(0,l.wg)(),(0,l.j4)(h,{"is-open":e.popover.show,class:"popover",animated:!1},{default:(0,l.w5)((()=>[(0,l._)("div",i,[e.popover.message.length?((0,l.wg)(),(0,l.iD)("div",r,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.popover.message,((e,t)=>((0,l.wg)(),(0,l.iD)("p",{class:"text",key:t},(0,s.zw)(e),1)))),128))])):(0,l.kq)("",!0),(0,l._)("div",d,[(0,l.Wm)(m,{class:"ion-margin-end"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"btn-cancel",onClick:e.cancel},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.buttonCancel),1)])),_:1},8,["onClick"])])),_:1}),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"btn-ok",onClick:e.ok},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.buttonOk),1)])),_:1},8,["onClick"])])),_:1})])])])),_:1},8,["is-open"])}var o=a(3687),u=a(3907);const c=(0,l.aZ)({name:"Popover",components:{IonButtons:o.Sm,IonButton:o.YG,IonModal:o.ki},props:{buttonOk:{type:String,default:""},buttonCancel:{type:String,default:""}},emits:["handler"],computed:{...(0,u.Se)(["popover"])},methods:{...(0,u.OI)(["SET_POPOVER"]),ok(){this.$emit("handler","ok")},cancel(){this.$emit("handler","cancel")}}});var m=a(3744);const h=(0,m.Z)(c,[["render",n]]),p=h},2859:(e,t,a)=>{a.d(t,{Z:()=>u});var l=a(6252),s=a(3577);function i(e,t,a,i,r,d){const n=(0,l.up)("ion-label"),o=(0,l.up)("ion-segment-button"),u=(0,l.up)("ion-segment");return(0,l.wg)(),(0,l.j4)(u,{value:e.handlerValue,onIonChange:t[0]||(t[0]=t=>e.changeSegment(t)),class:"segment-container",ref:"segment"},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{value:"left",class:"segment"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{class:"label"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.titleLeft),1)])),_:1})])),_:1}),(0,l.Wm)(o,{value:"right",class:"segment"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{class:"label"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.titleRight),1)])),_:1})])),_:1})])),_:1},8,["value"])}var r=a(3687);const d=(0,l.aZ)({name:"Segment",props:{value:{type:String,default:"left"},disabled:{type:Boolean,default:!1},titleLeft:{type:String,default:""},titleRight:{type:String,default:""}},emits:["change"],components:{IonSegment:r.cJ,IonSegmentButton:r.GO,IonLabel:r.Q$},computed:{handlerValue(){return this.value}},methods:{changeSegment(e){this.$emit("change",e.detail.value),this.disabled?this.$refs.segment.$el.value="left":this.$refs.segment.$el.value=this.handlerValue}}});var n=a(3744);const o=(0,n.Z)(d,[["render",i]]),u=o},9402:(e,t,a)=>{a.r(t),a.d(t,{default:()=>I});var l=a(6252),s=a(3577);const i={href:"#"};function r(e,t){const a=(0,l.up)("Header"),r=(0,l.up)("Loading"),d=(0,l.up)("Segment"),n=(0,l.up)("ion-row"),o=(0,l.up)("Address"),u=(0,l.up)("ion-icon"),c=(0,l.up)("ion-label"),m=(0,l.up)("ion-input"),h=(0,l.up)("ItemInput"),p=(0,l.up)("ion-checkbox"),f=(0,l.up)("ion-card-content"),v=(0,l.up)("ion-card"),b=(0,l.up)("CardInfo"),g=(0,l.up)("ItemDate"),w=(0,l.up)("Button"),_=(0,l.up)("ion-text"),y=(0,l.up)("ion-list"),E=(0,l.up)("ion-content"),k=(0,l.up)("Popover"),W=(0,l.up)("ion-page");return(0,l.wg)(),(0,l.j4)(W,{id:"pickup"},{default:(0,l.w5)((()=>[(0,l.Wm)(a,{title:e.$t("CHECKOUT"),back:""},null,8,["title"]),e.loading?((0,l.wg)(),(0,l.j4)(r,{key:0})):(0,l.kq)("",!0),e.loading?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(E,{key:1},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{class:"ion-padding-top ion-padding-start ion-padding-end"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{"title-left":e.$t("PICKUP"),"title-right":e.$t("COURIER"),onChange:t[0]||(t[0]=t=>e.handlerSegment(t)),disabled:e.handlerAmountDiscount,value:this.handler},null,8,["title-left","title-right","disabled","value"])])),_:1}),"left"===e.handler?((0,l.wg)(),(0,l.j4)(o,{key:0,title:e.$t("PICKUP-ADDRESS")},null,8,["title"])):(0,l.kq)("",!0),"right"===e.handler?((0,l.wg)(),(0,l.j4)(v,{key:1,class:"delivery"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{class:"content"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{class:"ion-align-items-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{icon:"assets/icon/delivery.svg",class:"ion-margin-end icon"}),(0,l.Wm)(c,{class:"title"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.$t("DELIVERY-ADDRESS")),1)])),_:1})])),_:1}),(0,l.Wm)(h,{lines:"",error:e.errorFields.street},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:e.address.street,"onUpdate:modelValue":t[1]||(t[1]=t=>e.address.street=t),"label-placement":"floating",label:e.$t("STREET-HOUSE-REQUIRED")},null,8,["modelValue","label"])])),_:1},8,["error"]),(0,l.Wm)(n,{class:"ion-nowrap"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{lines:""},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:e.address.apartment,"onUpdate:modelValue":t[2]||(t[2]=t=>e.address.apartment=t),"label-placement":"floating",label:e.$t("APARTMENT"),type:"tel"},null,8,["modelValue","label"])])),_:1}),(0,l.Wm)(h,{lines:"",class:"ion-margin-start"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:e.address.entrance,"onUpdate:modelValue":t[3]||(t[3]=t=>e.address.entrance=t),"label-placement":"floating",label:e.$t("ENTRANCE"),type:"tel"},null,8,["modelValue","label"])])),_:1}),(0,l.Wm)(h,{lines:"",class:"ion-margin-start"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:e.address.floor,"onUpdate:modelValue":t[4]||(t[4]=t=>e.address.floor=t),"label-placement":"floating",label:e.$t("FLOOR"),type:"tel"},null,8,["modelValue","label"])])),_:1})])),_:1}),(0,l.Wm)(h,{lines:""},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:e.address.comment,"onUpdate:modelValue":t[5]||(t[5]=t=>e.address.comment=t),"label-placement":"floating",label:e.$t("COMMENT-COURIER")},null,8,["modelValue","label"])])),_:1}),(0,l.Wm)(h,{lines:"none",class:"ion-margin-top"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{modelValue:e.address.rememberAddress,"onUpdate:modelValue":t[6]||(t[6]=t=>e.address.rememberAddress=t),labelPlacement:"end",justify:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"checkbox-title"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.$t("REMEMBER-ADDRESS")),1)])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(b,{title:e.$t("DATE-RECEIVING"),icon:e.handlerIconCalendar,description:"16 октября - ориентировочная дата получения. Мы дополнительно сообщим вам о доставке."},null,8,["title","icon"]),(0,l.Wm)(b,{title:e.$t("PAYMENT"),icon:e.handlerIconPayment,description:e.$t("PAYMENT-DESCRIPTION")},null,8,["title","icon","description"]),(0,l.Wm)(y,{class:"contact-form"},{default:(0,l.w5)((()=>[(0,l.Wm)(n,{class:"ion-margin-top ion-margin-start"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,{class:"title"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.$t("CONTACT-DETAILS")),1)])),_:1})])),_:1}),(0,l.Wm)(h,{lines:"",error:e.errorFields.firstname},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:e.fields.firstname,"onUpdate:modelValue":t[7]||(t[7]=t=>e.fields.firstname=t),error:e.errorFields.firstname,"label-placement":"floating",label:e.$t("FIRSTNAME-REQUIRED"),required:""},null,8,["modelValue","error","label"])])),_:1},8,["error"]),(0,l.Wm)(h,{lines:"",error:e.errorFields.lastname},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:e.fields.lastname,"onUpdate:modelValue":t[8]||(t[8]=t=>e.fields.lastname=t),"label-placement":"floating",label:e.$t("LASTNAME-REQUIRED"),required:""},null,8,["modelValue","label"])])),_:1},8,["error"]),(0,l.Wm)(h,{lines:"",error:e.errorFields.patronymic},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:e.fields.patronymic,"onUpdate:modelValue":t[9]||(t[9]=t=>e.fields.patronymic=t),"label-placement":"floating",label:e.$t("PATRONYMIC-REQUIRED"),required:""},null,8,["modelValue","label"])])),_:1},8,["error"]),(0,l.Wm)(h,{lines:"",id:"click-trigger",class:"ion-align-items-end"},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{value:e.formatDate(e.fields.birthday),"label-placement":"floating",label:e.$t("DATE-BIRTH")},null,8,["value","label"]),(0,l.Wm)(u,{icon:"assets/icon/calendar-courier.svg",class:"icon-calendar"})])),_:1}),(0,l.Wm)(g,{modelValue:e.fields.birthday,"onUpdate:modelValue":t[10]||(t[10]=t=>e.fields.birthday=t)},null,8,["modelValue"]),(0,l.Wm)(h,{lines:"",error:e.errorFields.email},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:e.fields.email,"onUpdate:modelValue":t[11]||(t[11]=t=>e.fields.email=t),type:"email","label-placement":"floating",label:e.$t("EMAIL")},null,8,["modelValue","label"])])),_:1},8,["error"]),(0,l.Wm)(w,{title:e.$t("CHECKOUT-ORDER"),class:"button-checkout",onClick:e.send},null,8,["title","onClick"]),(0,l.Wm)(n,{class:"ion-margin"},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{class:"text"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.$t("AGREEMENT-TEXT"))+" ",1),(0,l._)("a",i,(0,s.zw)(e.$t("PERSONAL-DATA")),1)])),_:1})])),_:1}),(0,l.Wm)(n,{class:"ion-margin ion-padding-bottom"},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{class:"text"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e.$t("REQUIRED-TEXT")),1)])),_:1})])),_:1})])),_:1})])),_:1})),(0,l.Wm)(k,{"button-ok":e.$t("OK"),onHandler:e.closePopover},null,8,["button-ok","onHandler"])])),_:1})}a(4916),a(5306);var d=a(3687),n=a(3907),o=a(4032),u=a(2859),c=a(8172),m=a(2845),h=a(8596),p=a(7906),f=a(9430),v=a(4045),b=a(5344),g=a(3226),w=a(7151),_=a(9248),y=a(323);const E={name:"Pickup",components:{ItemDate:b.Z,ItemInput:p.Z,Popover:f.Z,Button:h.Z,CardInfo:m.Z,Address:c.Z,Segment:u.Z,Header:o.Z,IonPage:d._i,IonContent:d.W2,IonRow:d.Nd,IonList:d.q_,IonCard:d.PM,IonCardContent:d.FN,IonIcon:d.gu,IonLabel:d.Q$,IonInput:d.pK,IonCheckbox:d.nz,IonText:d.yW,Loading:v.Z},mounted(){this.fields.firstname=this.handlerUser.firstname,this.fields.lastname=this.handlerUser.lastname,this.fields.patronymic=this.handlerUser.patronymic,this.fields.birthday=this.handlerUser.birthday,this.fields.email=this.handlerUser.email,this.SET_BASKET_USER(this.handlerUser.id)},data(){return{handler:"left",loading:!1,address:{id:"",street:"",apartment:"",entrance:"",floor:"",comment:"",rememberAddress:!1},fields:{firstname:null,lastname:null,patronymic:null,birthday:null,email:null},errorFields:{},requiredFields:["firstname","lastname","patronymic"],requiredFieldsAddress:["street"]}},computed:{...(0,n.Se)(["user","basket"]),handlerIconCalendar(){return"left"===this.handler?"assets/icon/calendar-pickup.svg":"assets/icon/calendar-courier.svg"},handlerIconPayment(){return"left"===this.handler?"assets/icon/payment-pickup.svg":"assets/icon/payment-courier.svg"},handlerAmountDiscount(){return this.basket.total_discount<2e3},handlerUser(){return this.user}},watch:{async created(){this.emptyFields={...this.fields}}},methods:{checkFields:g.d6,clearFields:g.Ee,checkFieldsAddress:g.fB,formatDate:y.p,...(0,n.OI)(["SET_POPOVER","SET_USER","SET_BASKET_USER","SET_BASKET","SET_ORDER"]),...(0,n.nv)(["updateUser","saveAddress","getAddress"]),created(){this.emptyFields={...this.fields}},validateEmail(){/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(this.fields.email)?this.errorFields.email="":this.errorFields.email=this.$t("INCORRECT-EMAIL")},async handlerAddress(){this.loading=!0,this.getAddress({type:"user",id:this.user.id}).then((e=>{e.map((({id:e,attributes:t})=>{this.id=e,this.address.street=t.street,this.address.apartment=t.apartment,this.address.entrance=t.entrance,this.address.floor=t.floor})),this.loading=!1})).catch((e=>{this.loading=!1,console.error(e)}))},async send(){if(this.loading=!0,"left"===this.handler&&!this.checkFields()){const e={...this.handlerUser};e.firstname=this.fields.firstname,e.lastname=this.fields.lastname,e.patronymic=this.fields.patronymic,e.birthday=this.fields.birthday,e.email=this.fields.email,this.SET_USER(e),await this.updateUser(e),await(0,w.fQ)(this.basket.order_product_details).then((e=>{(0,w.gO)({order_details:e,order:this.basket}).then((({data:e})=>{this.SET_ORDER(e.id),this.$router.replace({name:"Order"}),this.clearBasket(),this.loading=!1})).catch((e=>{this.loading=!1,console.error(e)}))})).catch((e=>{console.error(e)}))}if("right"===this.handler&&!this.checkFields()&&!this.checkFieldsAddress()){const e={...this.handlerUser};e.firstname=this.fields.firstname,e.lastname=this.fields.lastname,e.patronymic=this.fields.patronymic,e.birthday=this.fields.birthday,e.email=this.fields.email,this.SET_USER(e),await this.updateUser(e),await(0,w.fQ)(this.basket.order_product_details).then((e=>{(0,w.gO)({order_details:e,order:this.basket}).then((({data:e})=>{this.SET_ORDER(e.id);const t={type:"order",street:this.address.street,apartment:this.address.apartment,entrance:this.address.entrance,floor:this.address.floor,order:e.id};if(this.saveAddress(t),this.address.rememberAddress){if(!this.id){const e={type:"user",street:this.address.street,apartment:this.address.apartment,entrance:this.address.entrance,floor:this.address.floor,user:this.handlerUser.id};this.saveAddress(e)}if(this.id){const e={id:this.id,street:this.address.street,apartment:this.address.apartment,entrance:this.address.entrance,floor:this.address.floor,user:this.handlerUser.id};(0,_.y3)(e)}}this.$router.replace({name:"Order"}),this.clearBasket(),this.loading=!1})).catch((e=>{console.error(e)}))})).catch((e=>{console.error(e)}))}},clearBasket(){this.SET_BASKET({order_product_details:[],count:0,total_amount:0,total_discount:0,user:0}),this.clearFields()},async handlerSegment(e){"right"===e&&this.handlerAmountDiscount?this.SET_POPOVER({show:!0,message:[this.$t("PICKUP-MESSAGE")]}):(this.handler=e,"right"===this.handler&&await this.handlerAddress())},closePopover(){this.SET_POPOVER({show:!1,message:[]})}}};var k=a(3744);const W=(0,k.Z)(E,[["render",r]]),I=W}}]);
//# sourceMappingURL=166-legacy.886fdb61.js.map